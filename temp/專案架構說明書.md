# 專案架構說明書
本說明書目的在於介紹本專案架構，讓閱讀者快速瞭解本專案架構及運作方式。

## 專案目的
本專案為一個簡單的**會員資料庫管理系統**，使用**py程式修改excel檔案**，達到程式化、自動化的輸入、整理資料。

## 資料庫
- 本專案以一個**xlsx檔案**作為資料庫，以結構化方式記錄。
- 資料庫預設檔名為"**PERI_member_database.xlsx**"，放置於專案目錄中，下文若有稱**資料庫**，指的便是此檔案。
- 資料庫中有多個分頁，存放不同資料：
    - C_member：本分頁存放**會員基本資料**，在做任何操作或記錄前，必須先在此登記加入會員，以**會員編號**作為唯一識別id。
    - B_event：本分頁為**會員活動紀錄**，記錄會員的行為，包括購買課程、上課（使用已購買的課程）等。
    - A_main：本分頁為**會員紀錄彙總**，根據B_event分頁中會員行為進行彙總，查看會員剩餘堂數、款項狀況的總攬。
    - menu：本分頁為**課程價目表**，當會員購買課程時會按照購買的方案、堂數來定價，定價標準即參照本分頁。
    - coach：本分頁為**教練名單**，紀錄所有教練姓名、教練編號，以及所屬會員的會員編號字首（例如教練編號為"100"，會員編號字首為"1"，會員編號即為"1xx"）

## 專案目錄架構
- 根目錄：
    - **PERI_member_database.xlsx**：作為資料庫的excel檔案。
    - **code資料夾**：存放py程式的目錄。
        - **main.py**：執行的**主程式**，串聯所有功能。
        - **mod資料夾**：存放各模組py檔案的目錄。
            - **A_add_member.py**：處理新增會員功能的模組。
            - **B_purchase.py**：處理會員購買課程功能的模組。
            - **C_consume.py**：處理會員上課（使用已購買的課程）功能的模組。
            - **D_main_table.py**：處理更新資料庫中A_main分頁功能的模組。
            - **E_customized_course.py**：處理購買特殊課程時的流程模組。
            - **O_config.py**：存放某些固定參數。
            - **O_general.py**：處理某些通用函式（例如尋找資料庫、讀取特定sheet）
            - **O_backup.py**：處理資料庫備份機制，每次使用資料異動功能時便會自動執行備份，並確認備份檔案不超過50個。

## 專案功能
- 執行code/main.py便可啟動主要功能，提供A/B/C/D等四種功能供使用者選擇。
- 預期中的使用流程：
    1. 先使用**A功能**輸入資料，**登記加入成為會員**，並且以**會員編號**欄位作為會員唯一編號，後續行為也以該值識別會員。
    2. 成為會員後，需**使用B功能登記購買課程**，購買課程分為一般課程（固定方案）和特殊課程（堂數及單堂金額任選）。
    3. 登記購買後，**使用C功能來使用已經購買的課程**。
    4. 會員可持續上課，**直到剩餘堂數為0，便需重新購買課程方能繼續上課**。
    5. 每次輸入新的購課/上課記錄時，便會自動觸發A_main的更新。或使用者也可以**使用D功能主動更新A_main**（適用於直接改excel檔時系統不會自動更新）。
- 在輸入特定資料時設有防呆機制，例如驗證email格式是否合法、購課/上課者是否已加入會員、購買資料不可為負數等。
- 在首頁提供管理員密碼輸入框，只有通過驗證才能在其他頁面查看到會員列表或會員總覽。否則只能使用功能新增資料但無法查看會員列表。
