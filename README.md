# 簡易會員管理系統

![Python](https://img.shields.io/badge/Python-3.11%2B-blue) ![Streamlit](https://img.shields.io/badge/GUI-Streamlit-red)

## 簡介（Overview）
本專案目的為建立一個小型、易用的資料庫系統，管理會員資料及記錄會員活動。並使用Python開發後端功能操作資料庫，將繁瑣的流程簡化，節省文書工作時間。

## 限制（Constraint）
本專案為受委託開發，除了基本需求外，還有一些額外前提必須遵守。

1. 委託單位中並無技術人員，也無人能夠進行維護。
2. 考量預算及需求後，暫無上雲需求，一切以地端部署為主。

## 技術棧（Tech Stack）
- 程式語言：**Python**
- 資料庫：**Excel***
- GUI：**Streamlit**

<i><font size="2">*考量委託單位中並無技術人員，故選擇泛用檔案作為資料庫。[資料庫](#資料庫database)欄目中有更詳細說明。</font></i>

## 使用方式（Usage）
已製作快速啟動指令，使用者可快速啟用。
1. 下載專案repository。
2. 使用`pip install -r requirements.txt`安裝依賴套件。
3. 雙擊`main.bat`會自動執行啟動指令，開啟瀏覽器進入操作介面（預設為localhost:8501）

<br>

## 資料庫（Database）
存放於專案目錄中的**Excel檔案**。系統會根據檔名自動搜尋定位 *（故請勿擅自更改檔名）*。
- **技術選型**：委託單位中無技術人員，為避免特殊情形或意外發生時，無人可以解決的情形，故選擇泛用的Excel檔案作為資料庫。兼顧**程式操作的便利性**以及**一般使用者也可快速查看更改**的特性。
- **資料庫架構**：將檔案視為database、分頁視為table來操作。檔案中有以下分頁：
    1. **A_main**：會員結算資料，按照**會員編號**和**方案**進行分類結算，查看剩餘堂數與金額。
    2. **B_event**：會員活動記錄，當會員進行**購買**或**上課**時，會新增記錄在此分頁。
    3. **C_member**：會員資料，新增會員時需登記一些基本資料，記錄在此分頁。
    4. **menu**：課程價目表，為**靜態資料**，使用者有需要時才會手動更改。
    5 **coach**：教練名單列表，包含教練名稱與編號。為**靜態資料**，有需要才會手動更改。
- **注意事項**：直接修改Excel雖然快速靈活，但相對若無人管理可能會變得**混亂**甚至**錯誤**。建議仍主要透過程式操作，必要時才直接修改Excel，保持資料的一致和正確性。

<br>

## 系統功能（System Functions）
以下分為**主要功能**與**其他功能**介紹：

### 主要功能

**1. 新增會員**：在使用其他功能前，**務必將目標對象加入會員**。系統會驗證目標對象是否已是會員，若非會員則無法使用其他功能。且必須設定**會員編號**，此為每個會員獨有、不重複的ID，用以識別會員身分。

**2. 購買課程**：系統採用「**先買後用**」的消費機制。會員必須先購買一定數量的課程，才能使用（上課）。課程又分為兩類：
- **一般課程**：共有三種方案、四種堂數可選，金額皆為固定。
- **特殊課程**：堂數與單堂金額可任意輸入，提供客製化的購課方案。

**3. 會員上課**：可批量選取多位會員後執行，系統會將所有會員堂數`-1`。若會員剩餘堂數已經為0，系統會提醒並拒絕存取。*（建議上課前輸入，避免上完課才發現已無剩餘堂數）*

**4. 庫存結算**：在每次會員資料異動時（購課或上課）系統會自動結算，按照**會員編號**及**方案**計算每位會員的剩餘堂數及款項，並更新至資料庫。



### 其他功能

- **手動結算**：若直接開啟並修改Excel則不會觸發自動結算。需點擊**手動更新**功能才會觸發結算。
- **會員退款**：輸入會員編號及方案後會查詢剩餘堂數與金額，若確認退款，系統會新增一筆資料，**將該會員該方案的堂數與金額都扣除（歸零）**。
- **管理員權限**：在介面首頁可以輸入管理員密碼開啟權限。若登入為管理員，在各頁面均可**快速查看當前會員結算情形**。非管理員仍可使用各項功能，只是無法直接查看會員資料。
- **備份機制**：當使用者使用「**新增會員、購買課程、會員上課、會員退款、手動更新**」等功能並成功後會觸發**備份機制**，自動將當前Excel檔案複製一份至`backup`資料夾中。系統將保留**最多50個備份檔案**，若達到上限會自動從最舊的開始刪除。